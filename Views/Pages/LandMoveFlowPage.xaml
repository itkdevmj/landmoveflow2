<Page
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:dxdiag="http://schemas.devexpress.com/winfx/2008/xaml/diagram"
      xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
      xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
      xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
      xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
      xmlns:sys="clr-namespace:System;assembly=System.Runtime"
      x:Class="LMFS.Views.Pages.LandMoveFlowPage"
      xmlns:dxmvvm="http://schemas.devexpress.com/winfx/2008/xaml/mvvm"
      xmlns:xtraEditors="clr-namespace:DevExpress.XtraEditors;assembly=DevExpress.XtraEditors.v23.2"
      mc:Ignorable="d" 
      d:DesignHeight="600" d:DesignWidth="1280"
      Title="토지이동흐름도"
      Loaded="LandMoveFlowPage_OnLoaded"
      SizeChanged="LandMoveFlowPage_OnSizeChanged">

    <!--참고
    <Page.Resources>
        <Style x:Key="InfoCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="5"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>

        <Style x:Key="CardTitleStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="맑은고딕 MDL2 Assets"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>

        <Style x:Key="CardContentStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#555"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>

        <Style x:Key="CardLabelStyle" TargetType="TextBlock" BasedOn="{StaticResource CardContentStyle}">
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
    </Page.Resources>
    -->

    <DockPanel>

        <Grid DockPanel.Dock="Left" Width="320">

            <Grid.RowDefinitions>
                <RowDefinition Height="130" />
                <RowDefinition Height="90" />
                <RowDefinition />
            </Grid.RowDefinitions>

            <Border Background="#A3C6C4" BorderThickness="2" CornerRadius="10" Padding="5">
                <StackPanel Grid.Row="0" Margin="5,5,5,5">
                    <dxlc:LayoutGroup Orientation="Horizontal" Height="28" Margin="4">
                        <dxe:ComboBoxEdit IsTextEditable="False" 
                                          ItemsSource="{Binding UmdList}"
                                          ValueMember="umdCd" DisplayMember="umdCdNm"
                                          SelectedItem="{Binding SelectedUmd, Mode=TwoWay}"/>
                        <dxe:ComboBoxEdit IsTextEditable="False"
                                          ItemsSource="{Binding RiList}"
                                          ValueMember="riCd" DisplayMember="riCdNm"
                                          SelectedItem="{Binding SelectedRi}"/>
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup Orientation="Horizontal" Height="28" Margin="2">
                        <CheckBox Content="산" Name="IsSan" Width="78"/>
                        <!-- 본번 -->
                        <dxe:TextEdit EditValue="{Binding Bobn, UpdateSourceTrigger=PropertyChanged}"
                                      MaxLength="4" MaskType="Numeric" Mask="0000" MaskUseAsDisplayFormat="True"
                                      GotFocus="TextEdit_GotFocus"
                                      HorizontalContentAlignment="Center"
                                      VerticalContentAlignment="Center"
                                      Text="중앙 정렬 텍스트">
                            <dxe:TextEdit.InputBindings>
                                <KeyBinding Key="Enter" Command="{Binding EnterCommand}"></KeyBinding>
                            </dxe:TextEdit.InputBindings>
                        </dxe:TextEdit>
                        <Label Content="-" Width="15" Margin="0"/>
                        <!-- 부번 -->
                        <dxe:TextEdit EditValue="{Binding Bubn, UpdateSourceTrigger=PropertyChanged}"
                                      MaxLength="4" MaskType="Numeric" Mask="0000" MaskUseAsDisplayFormat="True"
                                      GotFocus="TextEdit_GotFocus"
                                      HorizontalContentAlignment="Center"
                                      VerticalContentAlignment="Center"
                                      Text="중앙 정렬 텍스트">
                            <dxe:TextEdit.InputBindings>
                                <KeyBinding Key="Enter" Command="{Binding EnterCommand}"></KeyBinding>
                            </dxe:TextEdit.InputBindings>
                        </dxe:TextEdit>
                    </dxlc:LayoutGroup>

                    <dxlc:LayoutGroup Orientation="Horizontal" HorizontalAlignment="Right" Height="28" Margin="4">
                        <Button Content="검색" Width="120" Command="{Binding SearchCommand}"/>
                    </dxlc:LayoutGroup>
                </StackPanel>
            </Border>
            <StackPanel Grid.Row="1" Margin="5,5,5,5">
                <dxlc:LayoutGroup Orientation="Horizontal" HorizontalAlignment="Right" Height="30"
                                  Margin="4 10 4 10">
                    <Button Content="다시 그리기" Width="120"/>
                </dxlc:LayoutGroup>
                <Border Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" BorderBrush="#A3C6C4" Background="#E0E7E9" BorderThickness="1" CornerRadius="5" Height="30">
                    <dxlc:LayoutGroup Orientation="Horizontal" HorizontalAlignment="Right" Height="25" Padding="4">
                        <CheckBox Content="[지목변경] 표시" IsChecked="{Binding JimokChg, Mode=TwoWay}" Height="25" Width="300">
                        </CheckBox>
                    </dxlc:LayoutGroup>
                </Border>
            </StackPanel>

<!--            <dxg:GridControl Grid.Row="2" Name="FlowDataGrid" AutoExpandAllGroups="True" AllowColumnMRUFilterList="False"
                                ItemsSource="{Binding GridDataSource}" SelectionMode="Row"
                                dx:ScrollBarExtensions.ScrollBarMode="TouchOverlap" ShowBorder="True"
                                Margin="4,0,4,4" Cursor="Hand">

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="MouseDoubleClick" 
                                            Command="{Binding FlowDataDoubleClickCommand}"
                                            PassEventArgsToCommand="True"
                                            />
                </dxmvvm:Interaction.Behaviors>

                <dxg:GridControl.View>
                    <dxg:TableView ShowIndicator="False" ShowGroupPanel="False" NavigationStyle="Row" AutoWidth="False">
                    </dxg:TableView>
                </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="bfPnu" Header="이동전" Width="1*" UnboundDataType="{x:Type sys:String}"
                                    ReadOnly="True" HorizontalHeaderContentAlignment="Center" />
                    <dxg:GridColumn FieldName="afPnu" Header="이동후" Width="1*" UnboundDataType="{x:Type sys:String}"
                                    ReadOnly="True" HorizontalHeaderContentAlignment="Center" />
                    <dxg:GridColumn FieldName="regDt" Header="정리일" Width="1*" HorizontalHeaderContentAlignment="Center"
                                    ReadOnly="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:DateEditSettings DisplayFormat="yyyyMMdd" ShowPopupIfReadOnly="False" HorizontalContentAlignment="Center" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="rsn" Header="종목" Width="1.2*" MinWidth="120" HorizontalHeaderContentAlignment="Center" 
                                    ReadOnly="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:TextEditSettings HorizontalContentAlignment="Center" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                </dxg:GridControl.Columns>                
            </dxg:GridControl>
-->


            <dxg:GridControl Grid.Row="2" Name="AnotherFlowDataGrid"
                             AutoExpandAllGroups="True" AllowColumnMRUFilterList="False"
                                ItemsSource="{Binding GridCategoryDataSource}"
                                SelectedItem="{Binding SelectedFlowData}" SelectionMode="Row"
                                dx:ScrollBarExtensions.ScrollBarMode="TouchOverlap" ShowBorder="True"
                                Margin="4,0,4,4" Cursor="Hand">

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="MouseDoubleClick" 
                                            Command="{Binding RowDoubleClickCommand}"
                                            CommandParameter="{Binding Path=SelectedItem, ElementName=AnotherFlowDataGrid}"
                                            PassEventArgsToCommand="True"
                                            />
                </dxmvvm:Interaction.Behaviors>

                <dxg:GridControl.View>
                    <dxg:TableView ShowIndicator="False" ShowGroupPanel="False" NavigationStyle="Row" AutoWidth="False">
                    </dxg:TableView>
                </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="regDt" Header="정리일" Width="1*" HorizontalHeaderContentAlignment="Center"
                                    ReadOnly="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:DateEditSettings DisplayFormat="yyyyMMdd" ShowPopupIfReadOnly="False" HorizontalContentAlignment="Center" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="rsn" Header="종목" Width="1.2*" MinWidth="120" HorizontalHeaderContentAlignment="Center" 
                                    ReadOnly="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:TextEditSettings HorizontalContentAlignment="Center" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                </dxg:GridControl.Columns>
                <!--<dxg:GridControl.TotalSummary>
                    <dxg:GridSummaryItem SummaryType="Count" Alignment="Right" />
                    <dxg:GridSummaryItem FieldName="FullName" SummaryType="Count" />
                </dxg:GridControl.TotalSummary>-->
            </dxg:GridControl>
             <!--- Hide : Unvisible(Collapsed) => Real DB Record -->
            <dxg:GridControl Grid.Row="2" Name="FlowDataGrid" Visibility="Collapsed" 
                             AutoExpandAllGroups="True" AllowColumnMRUFilterList="False"
                                ItemsSource="{Binding GridDataSource}" SelectionMode="Row"
                                dx:ScrollBarExtensions.ScrollBarMode="TouchOverlap" ShowBorder="True"
                                Margin="4,0,4,4" Cursor="Hand">

                <dxmvvm:Interaction.Behaviors>
                    <dxmvvm:EventToCommand EventName="MouseDoubleClick" 
                                            Command="{Binding FlowDataDoubleClickCommand}"
                                            PassEventArgsToCommand="True"
                                            />
                </dxmvvm:Interaction.Behaviors>

                <dxg:GridControl.View>
                    <dxg:TableView ShowIndicator="False" ShowGroupPanel="False" NavigationStyle="Row" AutoWidth="False">
                    </dxg:TableView>
                </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="bfPnu" Header="이동전" Width="1*" UnboundDataType="{x:Type sys:String}"
                                    ReadOnly="True" HorizontalHeaderContentAlignment="Center" />
                    <dxg:GridColumn FieldName="afPnu" Header="이동후" Width="1*" UnboundDataType="{x:Type sys:String}"
                                    ReadOnly="True" HorizontalHeaderContentAlignment="Center" />
                    <dxg:GridColumn FieldName="regDt" Header="정리일" Width="1*" HorizontalHeaderContentAlignment="Center"
                                    ReadOnly="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:DateEditSettings DisplayFormat="yyyyMMdd" ShowPopupIfReadOnly="False" HorizontalContentAlignment="Center" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="rsn" Header="종목" Width="1.2*" MinWidth="120" HorizontalHeaderContentAlignment="Center" 
                                    ReadOnly="True">
                        <dxg:GridColumn.EditSettings>
                            <dxe:TextEditSettings HorizontalContentAlignment="Center" />
                        </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                </dxg:GridControl.Columns>
                <!--<dxg:GridControl.TotalSummary>
                    <dxg:GridSummaryItem SummaryType="Count" Alignment="Right" />
                    <dxg:GridSummaryItem FieldName="FullName" SummaryType="Count" />
                </dxg:GridControl.TotalSummary>-->
            </dxg:GridControl>
        </Grid>

        <Border Background="WhiteSmoke" 
                BorderBrush="#A3C6C4"  BorderThickness="1" DockPanel.Dock="Top" Margin="0 0 0 0"
                CornerRadius="5">
            <!-- 5개의 원본 컬럼 정의 -->
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height = "50"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="110" />
                    <ColumnDefinition Width="80" />
                    <ColumnDefinition Width="80" />
                    <ColumnDefinition Width="*" /><!-- Space -->
                    <ColumnDefinition Width="120" />
                </Grid.ColumnDefinitions>
                <Border Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" BorderBrush="#A3C6C4" Background="#E0E7E9" BorderThickness="2" CornerRadius="5" Height="30" Margin="10 0 0 0">
                    <!-- 내부 Grid는 3컬럼을 하나로 감싸는 역할 -->
                    <Grid>                        
                        <Grid.RowDefinitions>
                            <RowDefinition Height = "40"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="100" />
                            <ColumnDefinition Width="70" />
                            <ColumnDefinition Width="70" />
                        </Grid.ColumnDefinitions>
                        <!--Mode=TwoWay 라는 건 화면에서 변경해도 ViewModel로 반영되고, ViewModel에서 변경해도 화면에 반영된다는 뜻-->
                        <CheckBox Grid.Column="0" IsChecked="{Binding IsOwnName, Mode=TwoWay}" Content="소유자명" Height="25" Margin="10 0 0 0" />
                        <CheckBox Grid.Column="1" IsChecked="{Binding IsJimok, Mode=TwoWay}" Content="지목" Height="25" Margin="0" />
                        <CheckBox Grid.Column="2" IsChecked="{Binding IsArea, Mode=TwoWay}" Content="면적" Height="25" Margin="0" />
                    </Grid>
                </Border>
                <!-- Spacer: Grid.Column="3"는 나머지 영역을 차지해서 오른쪽으로 밀어줍니다 -->
                <CheckBox Grid.Column="4" IsChecked="{Binding Portrait, Mode=TwoWay}" Content="세로형 그리기" Foreground="#6C7A89" FontWeight="Bold" Height="25" Margin="10 10 5 0" />
            </Grid>
            <!--<StackPanel Grid.Col="0" Margin="5,5,5,5">
                    <dxlc:LayoutGroup Orientation="Horizontal" Margin="10 5 0 0" Width="120"
                                      VerticalAlignment="Center" HorizontalAlignment="Left">
                        <CheckBox Content="소유자명 표시" Width="120"/>
                    </dxlc:LayoutGroup>
                </StackPanel>
            -->
        </Border>            

        <Border Background="#A3C6C4" BorderThickness="1" CornerRadius="5" Padding="3">
            <dxdiag:DiagramControl ShowRulers="False" IsReadOnly="True" x:Name="LmfControl" 
                                   DocumentSource="{Binding LandMoveFlowData}">
                <!--<dxmvvm:Interaction.Behaviors>
                    <dxdiag:DiagramDataBindingBehavior
                        ItemsSource="{Binding Path=Nodes}"
                        ConnectorsSource="{Binding Path=Connectors}"
                        KeyMember="Id"
                        ConnectorFromMember="Source"
                        ConnectorToMember="Target"
                        LayoutKind="Sugiyama" />
                </dxmvvm:Interaction.Behaviors>-->
            </dxdiag:DiagramControl>
        </Border>
    </DockPanel>

<!-- [참고]텍스트 중앙 정렬
HorizontalContentAlignment="Center"
VerticalContentAlignment="Center"
Text="중앙 정렬 텍스트"
-->
 
</Page>
